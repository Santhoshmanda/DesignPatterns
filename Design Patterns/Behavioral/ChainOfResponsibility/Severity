using System;

namespace ChainOfResponsibilityPattern
{
    // Enum for Request Severity Levels
    public enum Severity
    {
        Low,
        Medium,
        High
    }

    // Abstract Handler Class
    public abstract class Handler
    {
        protected Handler NextHandler;

        // Set the next handler in the chain
        public void SetNext(Handler nextHandler)
        {
            NextHandler = nextHandler;
        }

        // Process the request or pass it to the next handler
        public abstract void HandleRequest(Severity severity);
    }

    // Concrete Handler: Support Agent
    public class SupportAgent : Handler
    {
        public override void HandleRequest(Severity severity)
        {
            if (severity == Severity.Low)
            {
                Console.WriteLine("Support Agent handled the request (Low Severity).");
            }
            else if (NextHandler != null)
            {
                Console.WriteLine("Support Agent passed the request to the next handler.");
                NextHandler.HandleRequest(severity);
            }
            else
            {
                Console.WriteLine("Request could not be handled.");
            }
        }
    }

    // Concrete Handler: Supervisor
    public class Supervisor : Handler
    {
        public override void HandleRequest(Severity severity)
        {
            if (severity == Severity.Medium)
            {
                Console.WriteLine("Supervisor handled the request (Medium Severity).");
            }
            else if (NextHandler != null)
            {
                Console.WriteLine("Supervisor passed the request to the next handler.");
                NextHandler.HandleRequest(severity);
            }
            else
            {
                Console.WriteLine("Request could not be handled.");
            }
        }
    }

    // Concrete Handler: Manager
    public class Manager : Handler
    {
        public override void HandleRequest(Severity severity)
        {
            if (severity == Severity.High)
            {
                Console.WriteLine("Manager handled the request (High Severity).");
            }
            else if (NextHandler != null)
            {
                Console.WriteLine("Manager passed the request to the next handler.");
                NextHandler.HandleRequest(severity);
            }
            else
            {
                Console.WriteLine("Request could not be handled.");
            }
        }
    }

    // Client Code
    class Program
    {
        static void Main(string[] args)
        {
            // Create Handlers
            var agent = new SupportAgent();
            var supervisor = new Supervisor();
            var manager = new Manager();

            // Set up the chain
            agent.SetNext(supervisor);
            supervisor.SetNext(manager);

            // Handle Requests
            Console.WriteLine("Handling Low Severity Request:");
            agent.HandleRequest(Severity.Low);

            Console.WriteLine("\nHandling Medium Severity Request:");
            agent.HandleRequest(Severity.Medium);

            Console.WriteLine("\nHandling High Severity Request:");
            agent.HandleRequest(Severity.High);
        }
    }
}
